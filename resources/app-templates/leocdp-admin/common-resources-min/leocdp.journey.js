'use strict';const eventDataTypes=[{name:"First-party Data",id:1},{name:"Second-party Data",id:2},{name:"Third-party Data",id:3}],journeyStages=[{name:"AWARENESS",id:1},{name:"ATTRACTION",id:2},{name:"ASK",id:3},{name:"ACTION",id:4},{name:"ADVOCACY",id:5}],journeyStagesMap={1:"AWARENESS",2:"ATTRACTION",3:"ASK",4:"ACTION",5:"ADVOCACY"},scoringModels=[{name:"Lead Score",id:1},{name:"Prospect Score",id:2},{name:"Engagement Score",id:3},{name:"Loyalty Score",id:12},{name:"Data Quality Score",id:4},{name:"CAC Score",
id:5},{name:"CLV Score",id:6},{name:"Credit Score",id:11},{name:"Churn Score",id:13},{name:"CES Score",id:7},{name:"CSAT Score",id:8},{name:"CFS Score",id:9},{name:"NPS Score",id:10}],initJourneyMapAndTouchpointHubs=function(){var a=$("#journeyFlowChart").html('\x3cdiv class\x3d"loader"\x3e\x3c/div\x3e');loadJourneyMapAndTouchpointHubs(currentJourneyMapId,"#journeyFlowChart","#journeyMapName, #authorizedJourneyName","#touchpoint_hub_table",function(c,d){a.empty();loadJourneyTouchpointHubReport(window.currentJourneyMapId,
3*d);loadJourneyMapEventMatrix(window.currentJourneyMapId,"journey_map_event_matrix");5<=window.currentUserProfile.role&&loadSystemUsersForDataAuthorization(!0,c,$("#authorizedJourneyViewers"),$("#authorizedJourneyEditors"))})},refreshJourneyMapView=function(){currentJourneyMapId&&(location.hash="#calljs-leoCdpRouter('Data_Journey_Map','"+currentJourneyMapId+"','_refresh_"+(new Date).getTime()+"')")},loadJourneyFlowReport=function(){showJourneyFlowReport({journeyMapId:currentJourneyMapId},"journeyFlowReport")},
updateJourneyMap=function(a){a={touchpointHubJson:JSON.stringify($("#touchpoint_hub_table").jsGrid("option","data")),journeyMapId:currentJourneyMapId};LeoAdminApiUtil.callPostAdminApi("/cdp/journeymap/save",a,function(c){0===c.httpCode&&""===c.errorMessage?""!=c.data?refreshJourneyMapView():console.error("updateJourneyMap ",rs):LeoAdminApiUtil.logErrorPayload(c)})},loadFeedbackTemplateItems=function(a,c){LeoAdminApiUtil.getSecuredData("/cdp/asset-item/asset-templates",{obsid:a},function(d){cxFeedbackTemplates=
d.data.cxFeedbackTemplates;landingPageTemplates=d.data.landingPageTemplates;c()})},loadEventMetrics=function(){LeoAdminApiUtil.getSecuredData("/cdp/funnel/event-metrics",{},function(a){eventMetrics=a.data})};
var loadJourneyTemplate=function(){iziToast.info({title:"Information",message:"This function is under development and is not yet available"})},jsGridItemUrlTemplate=function(a){a=a.trim();return 0===a.indexOf("http")?(a=$("\x3ca\x3e").attr("href","javascript:").attr("title",a).attr("onclick","openUrlInNewTab(event,this)").text(a),$('\x3cdiv class\x3d"long_url_holder" \x3e\x3c/div\x3e').append(a)):$('\x3cdiv class\x3d"long_url_holder" \x3e\x3c/div\x3e').html(a)};
function initJourneyMapNameEditor(){var a="Journey Map: "+(new Date).toDateString(),c=function(b){LeoAdminApiUtil.callPostAdminApi("/cdp/journeymap/update-name",{journeyMapName:b,journeyMapId:currentJourneyMapId},function(e){0===e.httpCode&&""===e.errorMessage?(iziToast.success({title:"Data Journey Map",message:"\x3cb\x3e"+b+"\x3c/b\x3e is updated successfully!",timeout:2500}),loadJourneyMapList(!0)):LeoAdminApiUtil.logErrorPayload(e)})},d=$("#journeyMapName");$("#journeyMapNameEditor").blur(function(){var b=
$(this).val().trim();b=""===b?a:b;$("#journeyMapNameEditor").hide();d.text()!==b?(d.text(b).show(),c(b)):d.show()});$("#journeyMapNameEditor").keyup(function(b){"13"==(b.keyCode?b.keyCode:b.which)&&(b=$(this).val().trim(),b=""===b?a:b,$("#journeyMapNameEditor").hide(),d.text()!==b?(d.text(b).show(),c(b)):d.show())})}
function saveJourneyDataAuthorization(){var a=$("#authorizedJourneyViewers").val()||[],c=$("#authorizedJourneyEditors").val()||[];a={authorizedViewers:a,authorizedEditors:c,journeyMapId:currentJourneyMapId};a.updateAllProfilesInJourney=!0===$("#updateAllProfilesInJourney").prop("checked");LeoAdminApiUtil.callPostAdminApi("/cdp/journeymap/update-data-authorization",a,function(d){d.data===currentJourneyMapId?iziToast.success({title:"Data Journey Map",message:"\x3cb\x3eThe Data Journey Authorization of "+
$("#journeyMapName").text()+"\x3c/b\x3e is updated successfully!",timeout:3E3}):LeoAdminApiUtil.logErrorPayload(d)})}function loadJourneyStagesList(a){var c=$("#journeyStagesList");journeyStages.forEach(function(d){c.append('\x3coption value\x3d"'+d.id+'" \x3e'+d.name+"\x3c/option\x3e")});c.val("1").change();c.chosen({width:"100%",no_results_text:"Oops, nothing found!"}).trigger("chosen:updated").change(function(){"function"===typeof a&&a($(this).val())})}
function loadJourneyMapList(a,c,d,b){var e=$("#journeyMapList");!0===a&&e.find("option").remove().trigger("chosen:updated");LeoAdminApiUtil.getSecuredData("/cdp/journeymap/list-all",{_:(new Date).getTime()},function(f){0===f.httpCode&&""===f.errorMessage?(f=f.data,!0===d&&e.append('\x3coption value\x3d"" \x3e All Journey Maps \x3c/option\x3e'),f.forEach(function(m){e.append('\x3coption value\x3d"'+m.id+'" \x3e'+m.name+"\x3c/option\x3e")}),"string"===typeof currentJourneyMapId?e.val(currentJourneyMapId).change():
e.val("").change(),"function"===typeof b&&b(e.val(),e.find("option:selected").text()),e.chosen({width:"100%",no_results_text:"Oops, nothing found!"}).trigger("chosen:updated").change(function(){if("function"===typeof c){var m=$(this).val(),h=$(this).find("option:selected").text();c(m,h);"string"===typeof currentJourneyMapId&&(currentJourneyMapId=m)}else window.currentJourneyMapId=$(this).val(),refreshJourneyMapView()})):LeoAdminApiUtil.logErrorPayload(f)})}
function loadTouchpointHubList(a,c,d,b){var e=$("#touchpointHubList");!0===c&&e.find("option").remove().trigger("chosen:updated");c=$("#journeyMapList").val();""===c&&(c="id_default_journey");LeoAdminApiUtil.getSecuredData("/cdp/touchpointhub/list",{journeyMapId:c},function(f){0===f.httpCode&&""===f.errorMessage?(f.data.forEach(function(m){e.append('\x3coption value\x3d"'+m.id+'" \x3e'+m.name+"\x3c/option\x3e")}),"string"===typeof a&&e.val(a).change(),"function"===typeof b&&b(e.val(),e.find("option:selected").text()),
e.chosen({width:"100%",no_results_text:"Oops, nothing found!"}).trigger("chosen:updated").change(function(){if("function"===typeof d){var m=$(this).val(),h=$(this).find("option:selected").text();d(m,h)}}),$("#touchpointHubList_chosen").css("z-index","99")):LeoAdminApiUtil.logErrorPayload(f)})}function editJourneyMapName(){var a=$("#journeyMapName");$("#journeyMapNameEditor").val(a.text()).show().focus();a.hide()}
function createNewJourneyMap(){$("#dialogCreateNewJourneyMap").modal({backdrop:"static",keyboard:!1})}
function saveNewJourneyMap(){var a=$("#newJourneyMapName").val();5>=a.length?iziToast.error({title:"Journey Map Creation",message:"The journey map \x3cb\x3e"+a+"\x3c/b\x3e is too short, please enter at least 6 characters !",timeout:3E3}):($("#dialogCreateNewJourneyMap").modal("hide"),setTimeout(function(){LeoAdminApiUtil.callPostAdminApi("/cdp/journeymap/create-new",{journeyMapName:a},function(c){0===c.httpCode&&""===c.errorMessage?"string"===typeof c.data&&(currentJourneyMapId=c.data,notifySavedOK("Journey Data Map",
"The journey map \x3cb\x3e"+a+"\x3c/b\x3e has been created created successfully !"),refreshJourneyMapView()):LeoAdminApiUtil.logErrorPayload(c)})},1E3))}
function deleteCurrentJourneyMap(){if("string"===typeof currentJourneyMapId&&"id_default_journey"!=currentJourneyMapId){var a=$("#journeyMapList").find("option:checked").text();$("#delete_callback").val("");$("#confirmDeleteParentChildDialog").modal({focus:!0});$("#deleteChildItemMsg").text("Delete all touchpoint hubs and related data in this journey map!");$("#deleteChildItemCheckbox").prop("checked",!0);$("#deleteChildItem").show();var c="deleteJourneyMap"+currentJourneyMapId;window[c]=function(){var d=
baseLeoAdminUrl+"/cdp/journeymap/delete";$("#deleteChildItemCheckbox").is(":checked");LeoAdminApiUtil.callPostAdminApi(d,{journeyMapId:currentJourneyMapId},function(b){0===b.httpCode?!0===b.data?($("#deleteChildItem").hide(),$("#deleteChildItemMsg").text(""),iziToast.success({title:"OK",message:'Successfully deleted the journey map "'+a+'"',onClosing:function(e,f,m){currentJourneyMapId="id_default_journey";refreshJourneyMapView()}})):iziToast.error({title:"Error",message:b.data,onClosing:function(e,
f,m){locatio.href="/admin"}}):($("#error-on-save").html(b.errorMessage).show().delay(5E3).fadeOut("slow"),LeoAdminApiUtil.logErrorPayload(b))})};$("#delete_parent_callback").val(c);$("#deletedParentInfoTitle").text(a);$("#deletedParentInfoMsg").text("Do you want to delete the journey map ?")}}
var loadJourneyMap=function(a,c,d){LeoAdminApiUtil.getSecuredData("/cdp/journeymap/get",{id:a,_:(new Date).getTime()},function(b){if(0<b.errorCode)iziToast.error({title:"Data Journey Map",message:b.errorMessage});else{var e=b.data.journeyMap;b=e.defaultMetricName;var f=e.name,m=e.journeyStages,h=e.journeyLinks,p=e.journeyNodes;e=e.touchpointHubMap;$(d).text(f);renderJourneyFlowChart(c,b,m,p,h,e)}})};
function deleteTouchpointHubConfirmation(a,c){if(a&&c){$("#delete_callback").val("");$("#confirmDeleteDialog").modal({focus:!0});var d="deleteTouchpointHubConfirmation"+a;window[d]=function(){LeoAdminApiUtil.callPostAdminApi("/cdp/touchpointhub/delete",{id:a},function(b){0===b.httpCode&&""===b.errorMessage?iziToast.success({title:"Data Journey Map",message:c+" is deleted successfully!",timeout:3E3,onClosed:function(){refreshJourneyMapView()}}):LeoAdminApiUtil.logErrorPayload(b)})};$("#delete_callback").val(d);
$("#deletedInfoTitle").text("Touchpoint Hub Name: "+c).show();$("#deletedInfoMsg").text("Do you want to delete the selected touchpoint hub permanently?")}}
var loadJourneyMapAndTouchpointHubs=function(a,c,d,b,e){LeoAdminApiUtil.getSecuredData("/cdp/journeymap/get",{id:a,_:(new Date).getTime()},function(f){if(0<f.errorCode)iziToast.error({title:"Data Journey Map",message:f.errorMessage});else{var m=f.data.touchpointHubTypes,h=f.data.journeyMap,p=h.name,g=h.defaultMetricName,l=h.journeyStages,r=h.journeyLinks,t=h.journeyNodes,u=h.touchpointHubIndex,q=h.touchpointHubMap;$(d).text(p);"function"===typeof e&&e(h,t.length);renderJourneyFlowChart(c,g,l,t,r,
q);h=[];for(p in q)g=u[p],l=q[p],l.index=g+1,h[g]=l;p=[];for(u=1;30>=u;u++)p.push({Name:"[ "+u+" ]",Id:u});var w=[];Object.keys(m).forEach(k=>{var n=parseInt(k);0<n&&30!==n&&1E3>n&&w.push({typeName:m[k].replaceAll("_"," "),type:n})});u=f.canInsertData;g=f.canEditData;f=f.canDeleteData;var v=-1;$(b).jsGrid({width:"100%",height:"auto",inserting:u,editing:g,sorting:!0,paging:!1,confirmDeleting:!1,data:h,onItemInserting:function(k){k.item.totalProfile="number"===typeof k.item.totalProfile?k.item.totalProfile:
0;var n=k.item.type;null!=q[k.item.name]?(k.cancel=!0,iziToast.error({title:"Data Journey Map",message:k.item.name+" is duplicated, please enter a different name !"})):0<v&&!(30===n||1E3<=n)&&(k.item.index=v,v=-1)},onItemUpdating:function(k){var n=k.item,x=n.type;n=n.name;if(30===x||1E3<=x)k.cancel=!0,iziToast.error({title:"Data Journey Map",message:n+" is read-only touchpoint, you can not update it !"})},onItemInserted:function(k){iziToast.success({title:"Data Journey Map",message:k.item.name+" is inserted successfully!",
timeout:2500,onClosed:function(){updateJourneyMap(!0)}})},onItemUpdated:function(k){iziToast.success({title:"Data Journey Map",message:k.item.name+" is updated successfully!",timeout:2500,onClosed:function(){updateJourneyMap(!1)}})},onItemDeleting:function(k){k.cancel=!0;k=k.item;var n=k.name;30!=k.type?deleteTouchpointHubConfirmation(k.id,n):iziToast.error({title:"Data Journey Map",message:n+" is read-only touchpoint hub, you can not delete it !"})},onRefreshed:function(k){var n=k.grid._insertRow;
k=k.grid._bodyGrid;console.log(n);v=parseInt($(".jsgrid-grid-body tbody tr:last td:first").text())+1;$(n).find("td:first").text(v);$("\x3ctfoot\x3e\x3c/tfoot\x3e").appendTo(k).append(n)},fields:[{name:"index",title:"",type:"number",width:15,editing:!1,align:"center"},{name:"name",title:"Name",type:"text",width:60,validate:"required",align:"center",css:"touchpoint_hub_name"},{name:"type",title:"Type",type:"select",items:w,valueField:"type",textField:"typeName",width:58,css:"datatable_text",insertTemplate:function(){var k=
jsGrid.fields.select.prototype.insertTemplate.call(this);k.change(function(){var n=$(this).val();if(30==n||1E3<=n)iziToast.error({title:"Data Journey Map",message:"Can not select DATA OBSERVER, VISITOR REPORT, LEAD REPORT and CUSTOMER REPORT !"}),$("#touchpoint_hub_table").jsGrid("cancelEdit")});return k},editTemplate:function(k){var n=jsGrid.fields.select.prototype.editTemplate.call(this,k);return 30==k?"DATA OBSERVER":n},itemTemplate:function(k){var n=jsGrid.fields.select.prototype.itemTemplate.call(this,
k);return 30==k?"DATA OBSERVER":n}},{name:"journeyLevel",title:"Level",type:"select",items:p,valueField:"Id",textField:"Name",width:24},{name:"firstPartyData",title:"First-party Data",type:"CustomCheckBox",validate:"required",width:34,align:"center"},{name:"totalProfile",title:"Total Profile",type:"number",width:25,editing:!0,align:"center",css:"datatable_text",insertTemplate:function(){var k=this.__proto__.insertTemplate.call(this);k.val(0);return k},itemTemplate:function(k){return"\x3cspan\x3e"+
("number"===typeof k?k:0).toLocaleString()+"\x3c/span\x3e"},validate:{validator:"range",message:function(k,n){return'The total profile should be between 0 and 1,000,000,000. Entered age is "'+k+'" is out of specified range.'},param:[0,1E9]}},{name:"url",title:"URL or Location Address",type:"text",itemTemplate:jsGridItemUrlTemplate,validate:"required",align:"center"},{type:"control",deleteButton:f,width:22}]});u&&g||$("#touchpoint_hub_table").find(".jsgrid-button").click(errorNoAuthorization)}})};
const getJsTrackingCodeGA4=function(){var a="",c=$("#measurement_id_GA4").val().trim();if(""!==c){var d=_.template($("#google-analytics-javascript-tpl").html());a+="\n"+d({measurementId:c})+"\n"}return""!==a?"\x3cscript\x3e"+a+"\x3c/script\x3e\n":""},getJsCodeEventTrackingFunctions=function(){var a="",c=0;eventMetrics.forEach(function(d){if(!0===d.showInObserverJS){c++;var b="#leo-tracking-view-event-code-tpl";3===d.journeyStage||4===d.journeyStage||5===d.journeyStage?b=6===d.scoreModel?"#leo-tracking-conversion-event-code-tpl":
"#leo-tracking-action-event-code-tpl":6===d.journeyStage&&(b="#leo-tracking-feedback-event-code-tpl");b=_.template($(b).html());d={counter:c,eventMetricId:d.id,eventMetricName:d.eventLabel.replaceAll(" ","")};a+=b(d)}});return a},getTrackingJsCode=function(a){a=JSON.parse(decodeURIComponent($(a).data("json")));var c=a.id,d=a.name,b=a.type;a=a.dataSourceUrl;var e=window.baseLeoObserverDomain,f=window.baseStaticDomain;if(0<b&&12>b){$("#webDataObserverCodeDialog").modal({backdrop:"static",keyboard:!1});
$("#code_holder .CodeMirror").remove();b=$("#webDataObserverCodeDialog .code")[0];var m=CodeMirror.fromTextArea(b,{mode:"htmlmixed",lineNumbers:!0,styleActiveLine:!0,matchBrackets:!0,readOnly:!1});m.setSize(null,393);setTimeout(function(){var h=function(){var p=$("#leo_observer_auto_track").is(":checked"),g=$("#leo_observer_auto_collect_UTM").is(":checked"),l=$("#leo_observer_auto_collect_GA4").is(":checked"),r=$("#leo_observer_auto_track_all_links").is(":checked"),t=$("#leo_observer_auto_track_all_buttons").is(":checked");
l=l?getJsTrackingCodeGA4():"";var u=getJsCodeEventTrackingFunctions(),q=$("#webDataObserverCodeDialog .code").val().trim().replace("__leoObserverId__",c);q=q.replace("__tpHubName__",d);q=q.replace("__leoObserverDomain__",e);q=q.replace("__staticFileDomain__",f);q=q.replace("__eventTrackingFunctions__",u);q=p?g?q.replace("__autoTrackingFunctions__","LeoObserver.recordEventPageView(parseDataUTM())"):q.replace("__autoTrackingFunctions__","LeoObserver.recordEventPageView()"):q.replace("__autoTrackingFunctions__",
"// No auto tracking, please call it yourself");r&&(q+="\nLeoObserver.addTrackingAllLinks();\n");t&&(q+="\nLeoObserver.addTrackingAllButtons();\n");m.getDoc().setValue(l+"\x3cscript\x3e\n"+q+"\n\x3c/script\x3e");m.refresh();m.execCommand("selectAll")};$("#leo_observer_auto_track, #leo_observer_auto_collect_UTM, #leo_observer_auto_collect_GA4, #leo_observer_auto_track_all_links, #leo_observer_auto_track_all_buttons").change(function(){h()});$("#btn_ok_auto_collect_GA4").click(function(){h()});h();
addHandlerCopyCodeButton("#webDataObserverCodeDialog .code","#webDataObserverCodeDialog button.btn-copy-code")},350);b=$("#testObserverChromeExtBtn");b.attr({leoObserverId:c,leoObserverDomain:e,staticFileDomain:f,dataSourceUrl:a});b.click(function(){var h=$(this).attr("leoObserverId"),p=$(this).attr("leoObserverDomain"),g=$(this).attr("staticFileDomain"),l=$(this).attr("dataSourceUrl");l=0<l.indexOf("?")?l:l+"?";window.open(l+"_leoObserverLogDomain\x3d"+p+"\x26_leoObserverId\x3d"+h+"\x26_leoObserverCdnDomain\x3d"+
g,"_blank")})}else notifyErrorMessage("Can not get tracking code of offline touchpoint, please use QR code")},getCxFeedbackJsCode=function(a){a=JSON.parse(decodeURIComponent($(a).data("json")));var c=a.id;a=a.type;30>a?loadFeedbackTemplateItems(c,function(){if(0===$("#feedbackTemplateSelector option").length&&0<cxFeedbackTemplates.length)for(var d in cxFeedbackTemplates){var b='\x3coption value\x3d"'+d+'" \x3e'+cxFeedbackTemplates[d].title+"\x3c/option\x3e";$("#feedbackTemplateSelector").append(b)}$("#dialogEmbeddedCxFeedbackForm").modal({backdrop:"static",
keyboard:!1});$("#feedbackTemplateSelector").val("0").change();initEmbeddedFeedbackForm(c,"dialogEmbeddedCxFeedbackForm",cxFeedbackTemplates[0]);var e=$("#feedbackTemplateSelector");e.chosen({width:"100%",no_results_text:"Oops, nothing found!"}).trigger("chosen:updated").change(function(){var f=parseInt($(this).val());initEmbeddedFeedbackForm(c,"dialogEmbeddedCxFeedbackForm",cxFeedbackTemplates[f])});$("#leo_survey_in_shared_devices").change(function(){e.trigger("change")})}):notifyErrorMessage("Can not get feedback code for the touchpoint hub type \x3d "+
a)},getWebLeadFormJsCode=function(a){a=JSON.parse(decodeURIComponent($(a).data("json")));var c=a.id,d=a.name;a=a.type;if(0<a&&12>a){$("#webLeadFormCodeDialog").modal({backdrop:"static",keyboard:!1});$("#code_holder .CodeMirror").remove();a=$("#webLeadFormCodeDialog .code")[0];var b=CodeMirror.fromTextArea(a,{mode:"htmlmixed",lineNumbers:!0,styleActiveLine:!0,matchBrackets:!0,readOnly:!0});b.setSize(null,480);setTimeout(function(){var e=$("#webLeadFormCodeDialog .code").val().trim().replace("__leoObserverId__",
c);e=e.replace("__tpHubName__",d);e=e.replace("__LeoObserverDomain__",baseLeoObserverDomain);b.getDoc().setValue("\x3cscript\x3e\n"+e+"\n\x3c/script\x3e");b.refresh();b.execCommand("selectAll")},350)}},getQrImageFormCode=function(a){a=decodeURIComponent($(a).data("json"));a=JSON.parse(a);console.log("getQrImageFormCode ",a);var c=a.qrCodeData,d=window.baseUploadDomain;$("#qrImageFormCodeDialog").modal({backdrop:"static",keyboard:!1});a=c.landingPageUrl;var b=c.qrCodeImage,e=c.trackingUrl;c=c.shortUrl||
e.replace("/qrct/","/ct/");d="https://"+d+b.replace("./","/");$("#qrHrefUrl").attr("href",d);$("#qrImgSrc").attr("src",d);$("#qrTouchpointHubURL").val(a);$("#qrShortURL").val(c);$("#qrCodeImageURL").val(d)},getPersonalizeContentCode=function(a){$("#itemTypePersonalization").text("content");getPersonalizationCode(a,"contents")},getPersonalizeProductCode=function(a){$("#itemTypePersonalization").text("product");getPersonalizationCode(a,"products")},getPersonalizationCode=function(a,c){a=JSON.parse(decodeURIComponent($(a).data("json")));
var d=a.id,b=a.name;a=a.type;if(0<a&&12>a){$("#dialogEmbeddedRecomender").modal({backdrop:"static",keyboard:!1});$("#dialogEmbeddedRecomender .CodeMirror").remove();a=$("#dialogEmbeddedRecomender .code")[0];var e=CodeMirror.fromTextArea(a,{mode:"htmlmixed",lineNumbers:!0,styleActiveLine:!0,matchBrackets:!0,readOnly:!1});e.setSize(null,480);setTimeout(function(){var f=$("#dialogEmbeddedRecomender .code").val().trim(),m="https://"+baseLeoObserverDomain+"/ris/html/"+c;f=f.replace("__observerId__",d);
f=f.replace("__tpHubName__",b);f=f.replace("__personalizationUrl__",m);m="leo_recommender_"+d;e.getDoc().setValue('\x3cscript id\x3d"'+m+'"\x3e\n'+f+"\n\x3c/script\x3e");e.refresh();e.execCommand("selectAll");addHandlerCopyCodeButton("#dialogEmbeddedRecomender .code","#dialogEmbeddedRecomender button.btn-copy-code")},500)}},showRedisSourceInfo=function(a){a=decodeURIComponent($(a).data("json"));var c=JSON.parse(a).dataSourceUrl.split("/");a=c[2];c=c[3];$("#dataSourceConfigHostAndPort").text(a);$("#dataSourceConfigTouchpointName").text(c);
$("#redisSourceInfoDialog").modal({backdrop:"static",keyboard:!1})},showObserverApiInfo=function(a){a=decodeURIComponent($(a).data("json"));a=JSON.parse(a);console.log("showObserverApiInfo",a);var c=a.id;"leo_data_observer"===c?(c="default_access_key",$("#leoCdpApiTokenKey").val("default_access_key")):$("#leoCdpApiTokenKey").val(c);var d="string"===typeof a.accessTokens[c]?a.accessTokens[c]:"";$("#leoCdpApiTokenValue").val(d);$("#leoCdpApiObserverName").text(a.name);$("#leoCdpGetProfileApiUrl").val(baseLeoAdminUrl+
"/api/profile/save");$("#leoCdpTrackEventApiUrl").val(baseLeoAdminUrl+"/api/event/save");$("#leoCdpListEventsApiUrl").val(baseLeoAdminUrl+"/api/event/list?startIndex\x3d0\x26numberResult\x3d10\x26profileId\x3d{profile_ID}");$("#leoCdpWebhookUrl").val(baseLeoObserverUrl+"/webhook?tokenkey\x3d"+c+"\x26tokenvalue\x3d"+d+"\x26source\x3d");$("#observerApiInfoDialog").modal({backdrop:"static",keyboard:!1})},resetAccessTokenForLeoObserverApi=function(){var a=$("#leoCdpApiTokenKey").val();LeoAdminApiUtil.callPostAdminApi(baseLeoAdminUrl+
"/cdp/touchpointhub/reset-access-token",{observerId:a},function(c){0===c.httpCode&&""===c.errorMessage&&(c=c.data,$("#leoCdpApiTokenKey").val(c.tokenKey),$("#leoCdpApiTokenValue").val(c.tokenValue),iziToast.success({title:"Reset Access Token",message:"The new access token is generated successfully!"}))})},initDataObserverJsGridPlugin=function(){var a=function(c){jsGrid.Field.call(this,c)};a.prototype=new jsGrid.Field({sorter:function(c,d){return 0},itemTemplate:function(c){if(""!==c.data){console.log("observerModel ",
c);var d=c.data,b=c.type;c=c.firstPartyData;var e="";return 30===b?e+'\x3cdiv style\x3d"margin:68px 0;"\x3e \x3cbutton type\x3d"button" class\x3d"btn btn-do-now btn-get-code" onclick\x3d"showObserverApiInfo(this)" style\x3d"width:134px!important;"  data-json\x3d"'+(d+'" \x3e\x3ci class\x3d"fa fa-info-circle" style\x3d"font-size:1.1em" aria-hidden\x3d"true"\x3e\x3c/i\x3e API \x26 Webhook \x3c/button\x3e \x3c/div\x3e '):31===b?(e+='\x3cdiv style\x3d"margin:20px 0;"\x3e \x3cbutton type\x3d"button" class\x3d"btn btn-do-now btn-get-code" onclick\x3d"showRedisSourceInfo(this)" ',
e+(' data-json\x3d"'+d+'" \x3e\x3ci class\x3d"fa fa-info-circle" style\x3d"font-size:1.1em" aria-hidden\x3d"true"\x3e\x3c/i\x3e Redis Information \x3c/button\x3e \x3c/div\x3e')):32===b?(e+='\x3cdiv style\x3d"margin:20px 0;"\x3e \x3cbutton type\x3d"button" class\x3d"btn btn-do-now btn-get-code" onclick\x3d"showKafkaSourceInfo(this)" ',e+(' data-json\x3d"'+d+'" \x3e\x3ci class\x3d"fa fa-info-circle" style\x3d"font-size:1.1em" aria-hidden\x3d"true"\x3e\x3c/i\x3e Kafka Information \x3c/button\x3e \x3c/div\x3e')):
33===b?(e+='\x3cdiv style\x3d"margin:20px 0;"\x3e \x3cbutton type\x3d"button" class\x3d"btn btn-do-now btn-get-code" onclick\x3d"getQrImageFormCode(this)" ',e+(' data-json\x3d"'+d+'" \x3e\x3ci class\x3d"fa fa-qrcode" style\x3d"font-size:1.1em" aria-hidden\x3d"true"\x3e\x3c/i\x3e Get QR Code \x3c/button\x3e \x3c/div\x3e')):loadObserverActionButtons(c,b,d)}return""},insertTemplate:function(c){return this._insertCode=c},editTemplate:function(c){return this._editCode=c},insertValue:function(){return this._insertCode},
editValue:function(){return this._editCode}});jsGrid.fields.LeoDataObserver=a},loadObserverActionButtons=function(a,c,d){var b='\x3cdiv class\x3d"btn-group" \x3e \x3cbutton type\x3d"button" class\x3d"btn btn-primary dropdown-toggle" data-toggle\x3d"dropdown"\x3e \x3ci class\x3d"fa fa-code" style\x3d"font-size:1.1em" aria-hidden\x3d"true"\x3e\x3c/i\x3e Get Code\x3c/button\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-primary dropdown-toggle" data-toggle\x3d"dropdown"\x3e \x3cspan class\x3d"caret"\x3e\x3c/span\x3e \x3c/button\x3e\x3cul class\x3d"dropdown-menu" role\x3d"menu"\x3e';
a?(b=b+'\x3cli\x3e \x3cbutton type\x3d"button" class\x3d"btn btn-do-now btn-sm btn-get-code" onclick\x3d"getQrImageFormCode(this)"  data-json\x3d"'+(d+'" \x3e\x3ci class\x3d"fa fa-qrcode" style\x3d"font-size:1.1em" aria-hidden\x3d"true"\x3e\x3c/i\x3e  QR Image Code \x3c/button\x3e \x3c/li\x3e'),0<c&&12>c?(b=b+'\x3cli\x3e \x3cbutton type\x3d"button" class\x3d"btn btn-do-now  btn-sm btn-get-code" onclick\x3d"getTrackingJsCode(this)"  data-json\x3d"'+(d+'" \x3e\x3ci class\x3d"fa fa-code" style\x3d"font-size:1.1em" aria-hidden\x3d"true"\x3e\x3c/i\x3e Event Tracking Code \x3c/button\x3e \x3c/li\x3e\x3cli\x3e \x3cbutton type\x3d"button" class\x3d"btn btn-do-now btn-sm btn-get-code" onclick\x3d"getCxFeedbackJsCode(this)" '),
b+=' data-json\x3d"'+d+'" \x3e\x3ci class\x3d"fa fa-code" style\x3d"font-size:1.1em" aria-hidden\x3d"true"\x3e\x3c/i\x3e Survey Rating Forms \x3c/button\x3e \x3c/li\x3e\x3cli\x3e \x3cbutton type\x3d"button" class\x3d"btn btn-do-now  btn-sm btn-get-code" onclick\x3d"getPersonalizeContentCode(this)" ',b+=' data-json\x3d"'+d+'" \x3e\x3ci class\x3d"fa fa-code" style\x3d"font-size:1.1em" aria-hidden\x3d"true"\x3e\x3c/i\x3e Content Personalization \x3c/button\x3e \x3c/li\x3e\x3cli\x3e \x3cbutton type\x3d"button" class\x3d"btn btn-do-now  btn-sm btn-get-code" onclick\x3d"getPersonalizeProductCode(this)" ',
b+=' data-json\x3d"'+d+'" \x3e\x3ci class\x3d"fa fa-code" style\x3d"font-size:1.1em" aria-hidden\x3d"true"\x3e\x3c/i\x3e Product Personalization  \x3c/button\x3e \x3c/li\x3e'):(b+='\x3cli\x3e \x3cbutton type\x3d"button" class\x3d"btn btn-do-now btn-sm btn-get-code" onclick\x3d"getCxFeedbackJsCode(this)" ',b+=' data-json\x3d"'+d+'" \x3e\x3ci class\x3d"fa fa-code" style\x3d"font-size:1.1em" aria-hidden\x3d"true"\x3e\x3c/i\x3e Survey Rating Forms \x3c/button\x3e \x3c/li\x3e')):(b+='\x3cli\x3e \x3cbutton type\x3d"button" class\x3d"btn btn-do-now btn-sm btn-get-code" onclick\x3d"getQrImageFormCode(this)"',
b+=' data-json\x3d"'+d+'" \x3e\x3ci class\x3d"fa fa-qrcode" style\x3d"font-size:1.1em" aria-hidden\x3d"true"\x3e\x3c/i\x3e QR Image Code \x3c/button\x3e \x3c/li\x3e');b+='\x3cli\x3e \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-do-now btn-get-code" onclick\x3d"showObserverApiInfo(this)" ';return b+=' data-json\x3d"'+d+'" \x3e\x3ci class\x3d"fa fa-info-circle" style\x3d"font-size:1.1em" aria-hidden\x3d"true"\x3e\x3c/i\x3e API \x26 Webhook \x3c/button\x3e \x3c/li\x3e   \x3c/ul\x3e \x3c/div\x3e'},
loadDataObserverList=function(a){initDataObserverJsGridPlugin();LeoAdminApiUtil.getSecuredData("/cdp/observers",{journeyMapId:currentJourneyMapId},function(c){var d=c.data.eventObservers;c=c.data.touchpointHubTypes;for(var b=0;b<d.length;b++){var e=d[b];e.index=b+1;var f=c[e.type];e.typeName=f;var m=e.firstPartyData,h=e.type;f={id:e.id,name:e.name,type:h,typeName:f};f.collectDirectly=e.collectDirectly;f.qrCodeData=e.qrCodeData;f.accessTokens=e.accessTokens;f.securityCode=e.securityCode;f.dataSourceUrl=
e.dataSourceUrl;f=JSON.stringify(f);e.observerModel={type:h,data:encodeURIComponent(f),firstPartyData:m}}$(a).jsGrid({width:"100%",height:"auto",scroll:!0,inserting:!1,editing:!1,sorting:!1,paging:!1,data:d,fields:[{name:"index",title:"",type:"number",width:20,align:"center"},{name:"name",title:"Name",type:"string",align:"center",css:"observer_name"},{name:"id",title:"Unique ID",type:"string",width:68,align:"center",css:"observer_id"},{name:"firstPartyData",title:"First-party Data",type:"CheckBoxIcon",
width:40,align:"center"},{name:"collectDirectly",title:"Tracking directly",type:"CheckBoxIcon",width:40,align:"center"},{name:"dataSourceUrl",title:"URL",type:"UrlLink",width:120,align:"center",css:"observer_url"},{name:"observerModel",title:"Actions",type:"LeoDataObserver",width:72,align:"center"}]})})},loadDataJourneyMapsByFilter=function(a,c,d,b,e,f,m){var h=[{data:"name"},{data:"authorizedViewers"},{data:"authorizedEditors"},{data:"createdAt"},{data:"updatedAt"},{data:"defaultMetricName"}],p=
getUserSession();if(p)return $(b).DataTable({lengthMenu:[[20,30,40],[20,30,40]],processing:!0,serverSide:!0,searching:!0,search:{return:!0},ordering:!0,serverMethod:"POST",ajax:{url:baseLeoAdminUrl+"/cdp/journeymaps/filter",contentType:"application/json",beforeSend:function(g){$(d).show();$(c).hide();g.setRequestHeader("leouss",p)},data:function(g){var l=g.order[0];g.sortField=h[l.column].data;g.sortAsc="asc"===l.dir;g.searchValue=g.search.value;delete g.order;delete g.search;"function"===typeof e&&
(g=e(g),$(b).data("authorizedViewer",g.authorizedViewer),$(b).data("authorizedEditor",g.authorizedEditor));return JSON.stringify(g)},dataSrc:function(g){var l=g.canInsertData,r=g.canEditData,t=g.canDeleteData;$(b).data("canInsertData",l);$(b).data("canEditData",r);$(b).data("canDeleteData",t);"function"===typeof loadDataCallback&&loadDataCallback(g);$(d).hide();$(c).show();return g.data}},columnDefs:[{render:function(g,l,r){return'\x3cdiv class\x3d"highlight_text text-center" title\x3d"'+g+'" \x3e'+
textTruncate(g,150)+"\x3c/div\x3e"},targets:0,orderable:!1},{render:function(g,l,r){l=$(b).data("authorizedViewer");g=g.includes(l);l=r.id+"-viewer";"object"===typeof f&&(f[r.id]=g);return getTableRowCheckedBox(a,b,l,g)},targets:1},{render:function(g,l,r){l=$(b).data("authorizedEditor");g=g.includes(l);l=r.id+"-editor";"object"===typeof m&&(m[r.id]=g);return getTableRowCheckedBox(a,b,l,g)},targets:2},{render:function(g,l,r){return'\x3cdiv class\x3d"small text-center" style\x3d"color:#3300ff;" \x3e'+
moment.utc(g).local().format("YYYY-MM-DD HH:mm:ss")+"\x3c/div\x3e"},targets:3},{render:function(g,l,r){return'\x3cdiv class\x3d"small text-center" style\x3d"color:#3300ff;" \x3e'+moment.utc(g).local().format("YYYY-MM-DD HH:mm:ss")+"\x3c/div\x3e"},targets:4},{render:function(g,l,r){return'\x3cdiv class\x3d" text-center"  \x3e'+g+"\x3c/div\x3e"},targets:5},{render:function(g,l,r){return'\x3ca class\x3d"control" title\x3d"Segment Report" href\x3d"#calljs-leoCdpRouter(\'Data_Journey_Map\',\''+(r.id+'\')" \x3e \x3ci class\x3d"fa fa-info-circle" aria-hidden\x3d"true"\x3e\x3c/i\x3e View\x3c/a\x3e')},
targets:6}],columns:h})};var loadJourneyMapEventMatrix=function(a,c,d,b,e){LeoAdminApiUtil.getSecuredData(baseLeoAdminUrl+"/cdp/analytics360/event-matrix",{journeyMapId:a,beginFilterDate:d||"",endFilterDate:b||""},function(f){var m=f.data;"object"===typeof m?(renderMatrixChart("Event Matrix Report",c,m.xLabels,m.yLabels,m.dataList),"function"===typeof e&&e(m)):console.error(f)})};
const loadJourneyTouchpointHubReport=function(a,c){$("#journeyObserverChart").html('\x3cdiv class\x3d"loader"\x3e\x3c/div\x3e');LeoAdminApiUtil.getSecuredData(baseLeoAdminUrl+"/cdp/analytics360/touchpoint-hub-report",{journeyMapId:a,maxTouchpointHubSize:c},function(d){if(0===d.httpCode&&""===d.errorMessage)if(d=d.data,0<d.length){var b=[],e=[];d.forEach(function(f){b.push(f.name);e.push(f.eventCount)});renderHorizontalBarChart("journeyObserverChart",b,e)}else $("#journeyObserverChart").html('\x3cdiv class\x3d"alert alert-info" role\x3d"alert"\x3e No data available \x3c/h4\x3e');
else LeoAdminApiUtil.logErrorPayload(d)})};function showJourneyFlowReport(a,c){var d=$("#"+c).empty().html('\x3cdiv class\x3d"loader"\x3e\x3c/div\x3e'),b=baseLeoAdminUrl+"/cdp/analytics360/touchpoint-flow-report";a.startIndex=0;a.numberFlow=200;LeoAdminApiUtil.getSecuredData(b,a,function(e){0===e.httpCode&&""===e.errorMessage?(d.empty(),flowNetworkGraph=renderDirectedGraph(c,{nodes:e.data.nodes,edges:e.data.edges},e.data.rootNodeId)):LeoAdminApiUtil.logErrorPayload(e)})}
function setJourneyFlowGraphView(){"object"===typeof flowNetworkGraph&&setTimeout(function(){flowNetworkGraph.fit(!0)},300)}
function loadJourneyFlowReportDemo(){var a=cytoscape({container:document.getElementById("journeyFlowReport"),boxSelectionEnabled:!1,autounselectify:!0,minZoom:.5,maxZoom:5,style:cytoscape.stylesheet().selector("node").css({height:80,width:80,"background-fit":"cover","border-color":"#000","border-width":3,"border-opacity":.5}).selector("edge").css({"curve-style":"unbundled-bezier",width:4,"target-arrow-shape":"triangle","line-color":"#ffaaaa","target-arrow-color":"#ffaaaa"}).selector("#youtube").css({"background-image":"https://cdn-icons-png.flaticon.com/128/3670/3670147.png"}).selector("#tiktok").css({"background-image":"https://cdn-icons-png.flaticon.com/128/3669/3669950.png"}).selector("#google").css({"background-image":"https://cdn-icons-png.flaticon.com/128/281/281764.png"}).selector("#website").css({"background-image":"https://cdn-icons-png.flaticon.com/128/1927/1927746.png"}).selector("#sen_spa").css({"background-image":"https://cdn-icons-png.flaticon.com/128/3649/3649531.png"}).selector("#customer_service").css({"background-image":"https://cdn-icons-png.flaticon.com/128/1028/1028011.png"}).selector("#facebook").css({"background-image":"https://cdn-icons-png.flaticon.com/128/5968/5968764.png"}).selector("#customer_lead").css({"background-image":"https://cdn-icons-png.flaticon.com/128/950/950237.png"}).selector("#engaged_customer").css({"background-image":"https://cdn-icons-png.flaticon.com/128/4149/4149882.png"}).selector("edge[weight\x3e0]").style({label:"data(weight)",
"background-color":"#61bffc","font-size":20,width:5,"line-color":"#9BB6FB","target-arrow-color":"#0048FF"}).selector("edge[weight \x3e\x3d 20]").style({"line-color":"#618CF9","target-arrow-color":"#0048FF",width:7}).selector("edge[weight \x3e\x3d 7]").style({"line-color":"#F3A06D","target-arrow-color":"#F91805",width:9}).selector("edge[weight\x3d0]").style({"background-color":"#61bffc","font-size":20,"line-color":"#9BB6FB","target-arrow-color":"#0048FF"}).selector('node[type\x3d"cdp_profile"]').style({shape:"round-rectangle",
padding:"6px","line-color":"#F3A06D"}),elements:{nodes:[{data:{id:"google",type:""}},{data:{id:"youtube"}},{data:{id:"tiktok"}},{data:{id:"website"}},{data:{id:"sen_spa"}},{data:{id:"customer_service"}},{data:{id:"facebook"}},{data:{id:"customer_lead",type:"cdp_profile"}},{data:{id:"engaged_customer",type:"cdp_profile"}}],edges:[{data:{source:"google",target:"youtube",weight:0}},{data:{source:"google",target:"tiktok",weight:0}},{data:{source:"google",target:"website",weight:31}},{data:{source:"tiktok",
target:"website",weight:27}},{data:{source:"youtube",target:"website",weight:31}},{data:{source:"youtube",target:"facebook",weight:43}},{data:{source:"website",target:"sen_spa",weight:12}},{data:{source:"engaged_customer",target:"customer_service",weight:3}},{data:{source:"facebook",target:"customer_lead",weight:12}},{data:{source:"customer_lead",target:"website",weight:6}},{data:{source:"customer_lead",target:"sen_spa",weight:9}},{data:{source:"website",target:"engaged_customer",weight:21}},{data:{source:"sen_spa",
target:"engaged_customer",weight:11}}]},layout:{name:"dagre",rankDir:"LR",fit:!0,directed:!0,padding:50,spacingFactor:1.9,nodeSep:60,rankSep:30}});initPanZoomController(.5,5,a);a.nodeHtmlLabel([{query:"node",halign:"center",valign:"top",halignBox:"center",valignBox:"top",cssClass:"",tpl(c){var d=c.id.toUpperCase();return"cdp_profile"===c.type?'\x3ch4 class\x3d"cy_node_profile" \x3e '+d+"\x3c/h4\x3e":'\x3ch4 class\x3d"cy_node_touchpoint" \x3e '+d+"\x3c/h4\x3e"}}]);a.fit(50)}
const loadBehavioralEventList=function(){var a={block:{highlight:!0,fill:{type:"gradient"}},chart:{curve:{enabled:!0,height:36},height:360,bottomWidth:.57,bottomPinch:2},tooltip:{enabled:!0},label:{fontSize:"14px"},events:{click:{block:function(b){console.log(b.label.raw)}}}},c=function(b){b={eventMetricJson:JSON.stringify(b)};LeoAdminApiUtil.callPostAdminApi("/cdp/funnel/event-metric/save",b,function(e){0===e.httpCode&&""===e.errorMessage?""!=e.data?location.reload(!0):console.error("saveEventMetricMetaData ",
rs):LeoAdminApiUtil.logErrorPayload(e)})},d=function(b){$("#delete_callback").val("");$("#confirmDeleteDialog").modal({focus:!0});if("string"===typeof b){var e="deleteEventMetricMetaData"+b;window[e]=function(){LeoAdminApiUtil.callPostAdminApi("/cdp/funnel/event-metric/delete",{eventName:b},function(f){0===f.httpCode&&""===f.errorMessage?setTimeout(function(){location.reload(!0)},700):LeoAdminApiUtil.logErrorPayload(f)})};$("#delete_callback").val(e);$("#deletedInfoTitle").text("Event Metric: "+b).show();
$("#deletedInfoMsg").text("Delete Data Confirmation")}};LeoAdminApiUtil.getSecuredData("/cdp/funnel/metadata",{},function(b){var e=b.canInsertData,f=b.canDeleteData;b.canEditData||$("button.data-control").attr("disabled","disabled");behavioralMetricsData=b.data.behavioral_metrics;var m=behavioralMetricsData[0]?behavioralMetricsData[0].flowName:"general_business_event";customerFunnelStages=b.data.general_data_funnel;renderFunnelChart("#profile_funnel",customerFunnelStages,a,getColorCodeProfileFunnel);
$("#event_metrics_table").jsGrid({width:"100%",height:"auto",inserting:e,confirmDeleting:f,editing:!0,sorting:!1,paging:!1,data:behavioralMetricsData,deleteConfirm:function(h){return h.systemMetric?"The event metric \x3cb\x3e["+h.eventName+"]\x3c/b\x3e is the \x3cb\x3eevent metric of system\x3c/b\x3e. You can not delete this metric.":"The event metric ["+h.eventName+"] will be removed. Are you sure ? "},onItemInserting:function(h){$("tr \x3e td.jsgrid-cell:nth-of-type(1)").each(function(){var p=$(this).text().trim();
p===h.item.eventName&&(h.cancel=!0,iziToast.info({title:"Info",message:"The event ["+p+"] is already existed in the metric list!"}))});h.item.systemMetric=!1;h.item.dataType=1;h.item.flowName=m},onItemInserted:function(h){var p=h.item;""===p.eventName.trim()||""===p.eventLabel.trim()?h.cancel=!0:c(h.item)},onItemEditing:function(h){h.item.systemMetric&&iziToast.info({title:"Information Box",message:"The event \x3cb\x3e["+h.item.eventName+"]\x3c/b\x3e is the event metric of system. Be careful when you edit this metric !",
timeout:5E3})},onItemUpdated:function(h){c(h.item)},onItemDeleting:function(h){h.item.systemMetric&&(h.cancel=!0)},onRefreshed:function(h){$("input.jsgrid-insert-mode-button").click(function(){console.log($("tr.jsgrid-insert-row").find('input[type\x3d"number"]'));$("tr.jsgrid-insert-row").find('input[type\x3d"number"]').val(0)})},fields:[{name:"eventName",title:"Event Name",align:"center",type:"text",validate:"required",validate:"required"},{name:"eventLabel",title:"Event Label",align:"center",type:"text",
validate:"required"},{name:"score",title:"Event Score",type:"number",align:"center",width:40,validate:"required"},{name:"cumulativePoint",title:"Loyalty Point",type:"number",width:44,align:"center",validate:"required"},{name:"funnelStageId",title:"Default Funnel Stage",type:"select",items:customerFunnelStages,valueField:"id",textField:"name"},{name:"scoreModel",title:"Scoring Model",type:"select",items:scoringModels,width:80,valueField:"id",textField:"name"},{name:"journeyStage",type:"select",title:"Journey Stage",
items:journeyStages,align:"center",width:74,valueField:"id",textField:"name"},{name:"showInObserverJS",title:"Show in Tracking Code",type:"CustomCheckBox",width:48,align:"center"},{type:"control",width:70,editButton:!0,deleteButton:!0,itemTemplate:function(h,p){jsGrid.fields.control.prototype.itemTemplate.apply(this,arguments);var g=p.systemMetric,l=p.eventName;var r="Edit Event Name: "+l;$("\x3cbutton\x3e").data("eventName",l).attr({class:"jsgrid-custom-button",title:r}).html('\x3ci class\x3d"fa fa-cogs event-set-rules" style\x3d"" aria-hidden\x3d"true"\x3e\x3c/i\x3e').click(function(u){console.log("setRules button ",
$(this).data("eventName"));underDevelopment(this);u.stopPropagation()});var t="customGridEditbutton jsgrid-button jsgrid-edit-button";r=$("\x3cbutton\x3e").data("eventName",l).attr({class:t,title:"Edit Event Metric"}).click(function(u){console.log("Edit button ",$(this).data("eventName"))});t="customGridDeletebutton jsgrid-button jsgrid-delete-button";l=$("\x3cbutton\x3e").data("eventName",l).attr({class:t,title:"Delete Event Metric"}).click(function(u){var q=$(this).data("eventName");g?iziToast.info({title:"Information Box",
message:"The event \x3cb\x3e["+q+"]\x3c/b\x3e is the \x3cb\x3eevent metric of system\x3c/b\x3e. You can not delete this metric !"}):d(q);u.stopPropagation()});t=$("\x3cdiv\x3e");g?t.attr("title","Event metric of system"):(t.addClass("editable_event_metric"),t.attr("title","Click to edit or delete"));t.append(r).append(l);return t}}]})})};
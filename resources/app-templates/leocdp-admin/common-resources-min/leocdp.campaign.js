'use strict';var campaignReportView=function(c){location.hash="calljs-leoCdpRouter('Campaign_Info','"+c+"')"},campaignEditor=function(c){location.hash="calljs-leoCdpRouter('Campaign_Editor','"+c+"')"},campaignRunImmediately=function(c){console.log("campaignRunImmediately "+c)},campaignScheduler=function(c){console.log("campaignScheduler "+c)},campaignListRefresh=function(){location.hash="#calljs-leoCdpRouter('Automated_Campaigns','_refresh_"+(new Date).getTime()+"')"};
function loadCampaignList(){var c=getUserSession();c&&$("#campaign-list").DataTable({processing:!1,serverSide:!1,serverMethod:"POST",ajax:{url:baseLeoAdminUrl+"/cdp/campaigns/filter",contentType:"application/json",beforeSend:function(a){a.setRequestHeader("leouss",c)},data:function(a){console.log(a);return JSON.stringify(a)}},columnDefs:[{render:function(a,b,d){a=textTruncate(a,60);return'\x3ca title\x3d"'+d.name+'" href\x3d"javascript:campaignReportView(\''+(d.id+"')\" \x3e")+a+"\x3c/a\x3e"},targets:0},
{render:function(a,b,d){b="MANUALLY_CUSTOM";1===a?b="LEAD_GENERATION":2===a?b="REMARKETING":3===a?b="CROSS_SELLING":4===a?b="UPSELLING":5===a&&(b="REFERRAL_PROGRAM");return'\x3cdiv class\x3d"datatable_text text-center"\x3e'+b+"\x3c/div\x3e"},targets:1},{render:function(a,b,d){b="DRAFT";1===a?b="PLANNED":2===a?b="IN_PROGRESS":3===a?b="COMPLETED":4===a?b="CANCELED":-1===a&&(b="DELETED");return'\x3cdiv class\x3d"datatable_text text-center"\x3e'+b+"\x3c/div\x3e"},targets:2},{render:function(a,b,d){return'\x3cdiv class\x3d"datatable_text text-center"\x3e'+
a+"\x3c/div\x3e"},targets:3},{render:function(a,b,d){return moment.utc(new Date(a)).local().format("YYYY-MM-DD HH:mm:ss")},targets:4},{render:function(a,b,d){return a?moment.utc(new Date(a)).local().format("YYYY-MM-DD HH:mm:ss"):"-"},targets:5},{render:function(a,b,d){return a},targets:6},{render:function(a,b,d){a="javascript:campaignRunImmediately('"+d.id+"')";b="javascript:campaignScheduler('"+d.id+"')";d='\x3cdiv style\x3d"width:81px"\x3e \x3ca class\x3d"control" title\x3d"Campaign Details" href\x3d"javascript:campaignReportView(\''+
(d.id+'\')" \x3e\x3ci class\x3d"fa fa-line-chart" aria-hidden\x3d"true"\x3e\x3c/i\x3e Details\x3c/a\x3e \x3cbr\x3e\x3ca class\x3d"control" title\x3d"Campaign Editor" href\x3d"javascript:campaignEditor(\'')+(d.id+'\')" \x3e\x3ci class\x3d"fa fa-pencil-square-o" aria-hidden\x3d"true"\x3e\x3c/i\x3e  Edit\x3c/a\x3e \x3cbr\x3e');return d=d+('\x3ca class\x3d"control" title\x3d"Schedule campaign" href\x3d"'+b+'" \x3e\x3ci class\x3d"fa fa-clock-o" aria-hidden\x3d"true"\x3e\x3c/i\x3e Schedule\x3c/a\x3e  \x3cbr\x3e\x3ca class\x3d"control" title\x3d"Run campaign immediately" href\x3d"')+
(a+'" \x3e\x3ci class\x3d"fa fa-play" aria-hidden\x3d"true"\x3e\x3c/i\x3e Run \x3c/a\x3e \x3c/div\x3e')},targets:7}],columns:[{data:"name"},{data:"type"},{data:"status"},{data:"targetedSegmentIds"},{data:"updatedAt"},{data:"lastRunAt"},{data:"ownerDisplayName"},{data:"activationRules"}]})}
function loadCampaignEditor(c){LeoAdminApiUtil.callPostAdminApi(baseLeoAdminUrl+"/cdp/campaign/get",{id:c},function(a){0===a.httpCode&&""===a.errorMessage?(a.canEditData?$("button.data-control-edit").click(function(){location.hash="calljs-leoCdpRouter('Campaign_Editor','"+c+"')"}):$("button.data-control-edit").attr("disabled","disabled"),campaignModel=a.data,a=campaignModel.title,document.title="Campaign Details: "+a,$("#cp_title").text(a),loadAutomatedFlow()):LeoAdminApiUtil.logErrorPayload(a)})}
function loadAutomatedFlow(){function c(){mermaid.render("id",$(a).val()).then(({svg:d,bindFunctions:e})=>{b.innerHTML=d;e&&e(b)})}mermaid.initialize({startOnLoad:!1,securityLevel:"loose",useMaxWidth:!1});const a=document.getElementById("mermaidInput"),b=document.getElementById("mermaidOutput");a.addEventListener("input",c);c()}function automatedFlowNodeClick(c){console.log(c);notifySuccessMessage(c)};